"use strict";(self.webpackChunkweb_mzima_client=self.webpackChunkweb_mzima_client||[]).push([[152],{46152:(jt,I,r)=>{r.r(I),r.d(I,{DataSourcesModule:()=>x});var l=r(52954),c=r(93557),P=r(95432),C=r(94626),b=r(37661),T=r(33695),y=r(48281),A=r(56370),q=r(37366),d=r(25303),L=r(17733),u=r(81547),J=r(89857),m=r(40930),w=r(31415),S=r(10909),Q=r(76327),M=r(53886),f=r(49119),U=r(31020),p=r(59132),k=r(85566),F=r.n(k),t=r(39609),D=r(53625),N=r(6469),v=r(952),Y=r(93149);function $(n,o){if(1&n&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,e.provider&&!e.onCreating?"Edit "+e.provider.name+" Data Source":"Add Data Source"),"\n")}}function j(n,o){if(1&n&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("value",e.id)("data-qa",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function z(n,o){if(1&n&&(t.ynx(0),t.YNc(1,j,2,3,"mat-option",17),t.BQk()),2&n){const e=o.$implicit,a=t.oxw(3);t.xp6(1),t.Q6J("ngIf",!a.isProviderEnabled(e))}}function B(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",12)(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.TgZ(4,"span",13),t._uU(5,"*"),t.qZA()(),t.TgZ(6,"mat-form-field",14)(7,"mat-select",15),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw(2);return t.KtG(s.currentProviderId=i)})("selectionChange",function(i){t.CHM(e);const s=t.oxw(2);return t.KtG(s.setCurrentProvider(i.value))}),t.ALo(8,"translate"),t.YNc(9,z,2,1,"ng-container",16),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,5,"settings.data_sources.type_of_data_source")," "),t.xp6(5),t.Q6J("placeholder",t.lcZ(8,7,"settings.data_sources.choose_data_source"))("ngModel",e.currentProviderId)("data-qa","select-provider"),t.xp6(2),t.Q6J("ngForOf",e.providersData)}}function H(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",22)(1,"mat-slide-toggle",24),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw(3);return t.KtG(s.provider.enabled=i)})("change",function(i){t.CHM(e);const s=t.oxw(3);return t.KtG(s.turnOffDataSource(i))}),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.provider.enabled)("data-qa","toogle-available-provider"),t.xp6(1),t.hij(" ",t.lcZ(3,3,"settings.data_sources.enable_provider_message")," ")}}function E(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"div",20),t.YNc(2,H,4,5,"div",21),t.TgZ(3,"div",22)(4,"mat-slide-toggle",23),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw(2);return t.KtG(s.provider.visible_survey=i)}),t._uU(5),t.ALo(6,"translate"),t.qZA()()()()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",!e.onCreating),t.xp6(2),t.Q6J("ngModel",e.provider.visible_survey)("data-qa","toogle-import-to-survey"),t.xp6(1),t.hij(" ",t.lcZ(6,4,"settings.data_sources.associate_with_form")," ")}}function G(n,o){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,B,10,9,"div",10),t.YNc(2,E,7,6,"div",11),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.onCreating),t.xp6(1),t.Q6J("ngIf",e.currentProviderId)}}function K(n,o){1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"data_import.which_survey")))}function R(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(e.selectedSurvey.name)}}function X(n,o){if(1&n&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e)("data-qa",e.name),t.xp6(1),t.hij(" ",e.name," ")}}const V=function(n){return{datasource_type:n}};function W(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field",14)(1,"mat-select",26),t.NdJ("selectionChange",function(i){t.CHM(e);const s=t.oxw(2);return t.KtG(s.getSurveyAttributes(i.value))}),t.YNc(2,X,2,3,"mat-option",27),t.qZA(),t._UZ(3,"mat-hint",28),t.ALo(4,"titlecase"),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("data-qa","survey-select"),t.xp6(1),t.Q6J("ngForOf",e.surveyList),t.xp6(1),t.Q6J("translate","survey.choose_survey_field_desc")("translateParams",t.VKq(6,V,t.lcZ(4,4,null==e.provider?null:e.provider.name)))}}function tt(n,o){if(1&n&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij("",t.lcZ(2,1,null==e.provider?null:e.provider.name)," data")}}function et(n,o){if(1&n&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.label)," ")}}function nt(n,o){1&n&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"survey.survey_field")))}function ot(n,o){if(1&n&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("value",null==e?null:e.key)("data-qa",e.key),t.xp6(1),t.hij(" ",null==e?null:e.label," ")}}function at(n,o){if(1&n&&(t.TgZ(0,"div",41),t.YNc(1,ot,2,3,"mat-option",17),t.qZA()),2&n){const e=o.$implicit,a=t.oxw().$implicit;t.Q6J("data-qa","survey-attributes-list"),t.xp6(1),t.Q6J("ngIf",a.value===e.input)}}function it(n,o){if(1&n&&(t.TgZ(0,"td",37)(1,"div",12)(2,"mat-form-field",38)(3,"mat-select",39),t.ALo(4,"translate"),t.TgZ(5,"mat-option",40),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.YNc(8,at,2,2,"div",3),t.qZA()()()()),2&n){const e=o.$implicit,a=t.oxw(3);t.xp6(2),t.Q6J("data-qa","source-select"),t.xp6(1),t.Q6J("formControlName",e.label)("placeholder",t.lcZ(4,7,"data_import.leave_empty"))("data-qa",e.label),t.xp6(2),t.Q6J("value",null),t.xp6(1),t.hij(" ",t.lcZ(7,9,"data_import.leave_empty")," "),t.xp6(2),t.Q6J("ngForOf",a.surveyAttributesList)}}function rt(n,o){1&n&&t._UZ(0,"tr",42)}function st(n,o){1&n&&t._UZ(0,"tr",43)}const O=function(){return["name","field"]};function ct(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"h2"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"table",29),t.ynx(8,30),t.YNc(9,tt,3,3,"th",31),t.YNc(10,et,3,3,"td",32),t.BQk(),t.ynx(11,33),t.YNc(12,nt,3,3,"th",31),t.YNc(13,it,9,11,"td",32),t.BQk(),t.YNc(14,rt,1,0,"tr",34),t.YNc(15,st,1,0,"tr",35),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,6,"survey.choose_survey_field")),t.xp6(3),t.Oqu(t.lcZ(6,8,"survey.choose_survey_field_desc")),t.xp6(2),t.Q6J("dataSource",e.tableData)("data-qa","survey-table"),t.xp6(7),t.Q6J("matHeaderRowDef",t.DdM(10,O)),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(11,O))}}function lt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",12)(2,"mat-label")(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"strong"),t.YNc(7,K,3,3,"span",0),t.YNc(8,R,2,1,"span",0),t.qZA()(),t.YNc(9,W,5,8,"mat-form-field",25),t.qZA(),t.YNc(10,ct,16,12,"ng-container",0),t.BQk()),2&n){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,5,"data_import.import_to")),t.xp6(3),t.Q6J("ngIf",!(null!=e.selectedSurvey&&e.selectedSurvey.id)),t.xp6(1),t.Q6J("ngIf",null==e.selectedSurvey?null:e.selectedSurvey.id),t.xp6(1),t.Q6J("ngIf",e.surveyList.length),t.xp6(1),t.Q6J("ngIf",null==e.surveyAttributesList?null:e.surveyAttributesList.length)}}function dt(n,o){if(1&n&&(t.TgZ(0,"h2"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.label)}}function mt(n,o){if(1&n&&t._UZ(0,"p",48),2&n){const e=t.oxw(2).$implicit;t.Q6J("innerHTML",e.description,t.oJD)}}function ut(n,o){if(1&n&&(t.ynx(0),t.YNc(1,dt,2,1,"h2",0),t.YNc(2,mt,1,1,"p",47),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==e.label?null:e.label.length),t.xp6(1),t.Q6J("ngIf",null==e.description?null:e.description.length)}}function pt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"input",49),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("formControlName",e.id)("data-qa","control-text"+e.id)}}function _t(n,o){1&n&&(t.TgZ(0,"span",13),t._uU(1,"*"),t.qZA())}function ft(n,o){if(1&n&&t._UZ(0,"mat-hint",48),2&n){const e=t.oxw(3).$implicit;t.Q6J("innerHTML",e.description,t.oJD)}}function vt(n,o){1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"form.field_required")," "))}function gt(n,o){if(1&n&&(t.TgZ(0,"mat-form-field",38),t._UZ(1,"input",53),t.YNc(2,ft,1,1,"mat-hint",47),t.YNc(3,vt,3,3,"mat-error",0),t.qZA()),2&n){const e=t.oxw(2).$implicit,a=t.oxw();let i;t.Q6J("data-qa","control-type-text"),t.xp6(1),t.Q6J("placeholder",e.description)("formControlName",e.id)("type",e.input)("data-qa","control-text"+e.id),t.xp6(1),t.Q6J("ngIf",null==e.description?null:e.description.length),t.xp6(1),t.Q6J("ngIf",((null==(i=a.form.get(e.id))?null:i.touched)||(null==(i=a.form.get(e.id))?null:i.dirty))&&(null==(i=a.form.get(e.id))?null:i.hasError("required")))}}function ht(n,o){if(1&n&&(t.TgZ(0,"mat-radio-button",18),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e)("data-qa","control-text"+e),t.xp6(1),t.hij(" ",e," ")}}function xt(n,o){if(1&n&&(t.TgZ(0,"mat-radio-group",54),t.YNc(1,ht,2,3,"mat-radio-button",27),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.Q6J("formControlName",e.id)("data-qa","control-type-radio"),t.xp6(1),t.Q6J("ngForOf",e.options)}}function Ct(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",12)(2,"mat-label"),t._uU(3),t.YNc(4,_t,2,0,"span",50),t.qZA(),t.YNc(5,gt,4,7,"mat-form-field",51),t.YNc(6,xt,2,3,"mat-radio-group",52),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",e.label," "),t.xp6(1),t.Q6J("ngIf",(null==e.rules?null:e.rules.indexOf("required"))>-1),t.xp6(1),t.Q6J("ngIf","text"===e.input),t.xp6(1),t.Q6J("ngIf","radio"===e.input)}}function bt(n,o){if(1&n&&(t.TgZ(0,"div",41),t.ynx(1,44),t.YNc(2,ut,3,2,"ng-container",45),t.YNc(3,pt,2,2,"ng-container",45),t.YNc(4,Ct,7,4,"ng-container",46),t.BQk(),t.qZA()),2&n){const e=o.$implicit;t.Q6J("data-qa","provider-options"),t.xp6(1),t.Q6J("ngSwitch",e.input),t.xp6(1),t.Q6J("ngSwitchCase","read-only-text"),t.xp6(1),t.Q6J("ngSwitchCase","hidden")}}function yt(n,o){1&n&&t._UZ(0,"div",55)}function St(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"app.delete")))}function Dt(n,o){1&n&&t._UZ(0,"mat-icon",58)}function Zt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mzima-client-button",56),t.NdJ("buttonClick",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.turnOffDataSource(i))}),t.YNc(1,St,3,3,"ng-container",0),t.YNc(2,Dt,1,0,"mat-icon",57),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("iconOnly",!e.isDesktop)("data-qa","btn-provider-delete"),t.xp6(1),t.Q6J("ngIf",e.isDesktop),t.xp6(1),t.Q6J("ngIf",!e.isDesktop)}}function It(n,o){1&n&&t._UZ(0,"app-spinner",59)}class _ extends U.H{sessionService;breakpointService;fb;ref;route;router;configService;dataSourcesService;confirmModalService;surveysService;formsService;translate;location;provider;surveyList;form;dataSourceList;selectedSurvey;surveyAttributesList;currentProviderId;availableProviders;onCreating;submitted=!1;providersData;cloneProviders;tableData;isLoading=!1;constructor(o,e,a,i,s,Z,Lt,wt,Mt,Ut,kt,Ft,$t){super(o,e),this.sessionService=o,this.breakpointService=e,this.fb=a,this.ref=i,this.route=s,this.router=Z,this.configService=Lt,this.dataSourcesService=wt,this.confirmModalService=Mt,this.surveysService=Ut,this.formsService=kt,this.translate=Ft,this.location=$t,this.checkDesktop(),this.form=this.fb.group({})}ngOnInit(){this.currentProviderId=this.route.snapshot.paramMap.get("id"),this.currentProviderId||(this.onCreating=!0),this.getProviders()}loadData(){}getAvailableProviders(o){const e=[];for(const a in o)e.push({id:o[a]["provider-name"],name:o[a]["provider-name"],type:o[a].enabled});return S.RD.sortArray(e.filter(a=>!a.type))}objectToArray(o){return Object.keys(o).map(e=>({label:e,value:o[e]}))}getProviders(){this.isLoading=!0;const o=this.dataSourcesService.getDataSource().pipe((0,Q.w)(a=>this.configService.getProvidersData(a))),e=this.surveysService.get();(0,M.a)([o,e]).subscribe({next:([a,i])=>{this.surveyList=i.results,this.providersData=S.RD.sortArray(a,"name"),this.providersData.map(s=>{s.visible_survey=!!s.params.form_id,s.selected_survey=this.surveyList.find(Z=>Z.id===s.params.form_id)}),this.cloneProviders=F().cloneDeep(this.providersData),this.setCurrentProvider(),this.isLoading=!1}})}setCurrentProvider(o){if(this.currentProviderId||o){const e=this.currentProviderId||o;this.provider=this.providersData.find(a=>a.id===e),this.removeControls(this.form.controls),this.createForm(this.provider),this.addControlsToForm("id",this.fb.control(this.provider.id,c.kI.required)),this.getSurveyAttributes(this.provider.selected_survey)}}getSurveyAttributes(o){o&&(this.form.patchValue({form_id:o}),this.selectedSurvey=o,this.formsService.getAttributes(o.id,{order:"asc",orderby:"priority"}).subscribe({next:a=>{this.surveyAttributesList=a,this.tableData=this.objectToArray(this.provider.inbound_fields);for(const i of this.tableData)this.addControlsToForm(i.label,this.fb.control("")),this.form.patchValue({[i.label]:this.checkKeyFields(this.provider.params[i.label])})}}))}ngAfterContentChecked(){this.ref.detectChanges()}createForm(o){this.addControlsToForm("form_id",this.fb.control(this.provider?.selected_survey)),this.createControls(o.options)}removeControls(o){for(const[e]of Object.entries(o))this.form.removeControl(e)}createControls(o){for(const e of o){const a=[];if(e?.rules)for(const i of e.rules)"required"===i&&a.push(c.kI.required);this.addControlsToForm(e.id,this.fb.control(e.value,a))}}addControlsToForm(o,e){this.form.addControl(o,e)}turnOffDataSource(o){var e=this;return(0,w.Z)(function*(){o.checked||(e.cloneProviders.find(i=>i.id===e.provider.id).enabled=o.checked,(yield e.confirmModalService.open({title:e.translate.instant("settings.data_sources.provider_name",{providerName:e.provider.name}),description:e.translate.instant("settings.data_sources.do_you_really_want_to_disconnect"),confirmButtonText:e.translate.instant("app.yes_delete"),cancelButtonText:e.translate.instant("app.no_go_back")}))&&e.configService.updateProviderById(e.form.value.id,e.prepareAPI(!1)[e.form.value.id]).subscribe({next:()=>e.router.navigate(["/settings/data-sources"]),error:()=>e.submitted=!1})),e.cloneProviders.find(a=>a.id===e.provider.id).enabled=o.checked})()}saveProviderData(){this.submitted=!0;const o=this.prepareAPI()[this.form.value.id];this.configService.updateProviderById(this.form.value.id,o).subscribe({next:()=>this.router.navigate(["/settings/data-sources"]),error:()=>this.submitted=!1})}prepareAPI(o=!0){const e=this.cloneProviders.find(a=>a.id===this.form.value.id);if(e){const a={};if(a[this.form.value.id]={},a[this.form.value.id].params=this.form.value,a[this.form.value.id].enabled=o,this.provider.visible_survey){if(a[this.form.value.id]["provider-name"]=this.form.value.id,a[this.form.value.id].params.form_id=this.form.value.form_id.id,a[this.form.value.id].params.form_id){const i={};for(const s of this.tableData)i[s.label]=this.form.value[s.label];a[this.form.value.id].params.inbound_fields=i}}else delete a[this.form.value.id].params.form_id,delete a[this.form.value.id].params.inbound_fields;return{...a}}for(const a in e.params)e.params[a]=this.form.value[a];if(this.provider.visible_survey){if(e.form_id=this.form.value.form_id.id,e.form_id){const a={};for(const i of this.tableData)a[i.label]=this.form.value[i.label];e.inbound_fields=a}}else delete e.form_id,delete e.inbound_fields;return{...e}}checkKeyFields(o){return"title"===o||"content"===o?this.filterAttributes("type","title"===o?o:"description")?.key:o?o.replace(/values./gi,""):void 0}filterAttributes(o,e){return this.surveyAttributesList.find(a=>a[o]===e)}fillForApi(o){return o?"title"===o.type||"description"===o.type?"title"===o.type?o.type:"content":`values.${o.key}`:""}back(){this.isDesktop?this.router.navigate(["settings/data-sources"]):this.location.back()}isProviderEnabled(o){return o.enabled}static \u0275fac=function(e){return new(e||_)(t.Y36(p.mj),t.Y36(p.r),t.Y36(c.qu),t.Y36(t.sBO),t.Y36(m.gz),t.Y36(m.F0),t.Y36(p.E4),t.Y36(f.DS),t.Y36(p.hP),t.Y36(f.w4),t.Y36(f.s8),t.Y36(u.sK),t.Y36(l.Ye))};static \u0275cmp=t.Xpm({type:_,selectors:[["app-data-source-item"]],features:[t.qOj],decls:19,vars:17,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"formGroup","ngSubmit"],[3,"data-qa",4,"ngFor","ngForOf"],["class","form-controls-spacer",4,"ngIf"],[1,"form-controls-panel","form-controls-panel--sticky"],["color","danger","class","delete-btn",3,"iconOnly","data-qa","buttonClick",4,"ngIf"],["fill","outline","color","secondary",3,"data-qa","buttonClick"],["type","submit",3,"disabled","data-qa"],["showLoader",""],["class","form-row",4,"ngIf"],["class","survey",4,"ngIf"],[1,"form-row"],[1,"color-accent"],["appearance","outline"],["disableOptionCentering","",3,"placeholder","ngModel","data-qa","ngModelChange","selectionChange"],[4,"ngFor","ngForOf"],[3,"value","data-qa",4,"ngIf"],[3,"value","data-qa"],[1,"survey"],[1,"form-row","toggle-group"],["class","toggle",4,"ngIf"],[1,"toggle"],["name","import-to-survey",3,"ngModel","data-qa","ngModelChange"],["name","accept-survey",3,"ngModel","data-qa","ngModelChange","change"],["appearance","outline",4,"ngIf"],["formControlName","form_id",3,"data-qa","selectionChange"],[3,"value","data-qa",4,"ngFor","ngForOf"],[3,"translate","translateParams"],["mat-table","",1,"survey__table",3,"dataSource","data-qa"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","field"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["appearance","outline",3,"data-qa"],["disableOptionCentering","",3,"formControlName","placeholder","data-qa"],[3,"value"],[3,"data-qa"],["mat-header-row",""],["mat-row",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],["type","hidden",3,"formControlName","data-qa"],["class","color-accent",4,"ngIf"],["appearance","outline",3,"data-qa",4,"ngIf"],["aria-label","Select an option",3,"formControlName","data-qa",4,"ngIf"],["matInput","",3,"placeholder","formControlName","type","data-qa"],["aria-label","Select an option",3,"formControlName","data-qa"],[1,"form-controls-spacer"],["color","danger",1,"delete-btn",3,"iconOnly","data-qa","buttonClick"],["icon","","svgIcon","delete",4,"ngIf"],["icon","","svgIcon","delete"],[1,"spinner"]],template:function(e,a){if(1&e&&(t.YNc(0,$,3,3,"h1",0),t.YNc(1,G,3,2,"div",1),t.TgZ(2,"form",2),t.NdJ("ngSubmit",function(){return a.saveProviderData()}),t.YNc(3,lt,11,7,"ng-container",0),t._UZ(4,"br"),t.YNc(5,bt,5,4,"div",3),t.YNc(6,yt,1,0,"div",4),t.TgZ(7,"div",5)(8,"div"),t.YNc(9,Zt,3,4,"mzima-client-button",6),t.qZA(),t.TgZ(10,"div")(11,"mzima-client-button",7),t.NdJ("buttonClick",function(){return a.back()}),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"mzima-client-button",8),t._uU(15),t.ALo(16,"translate"),t.qZA()()()(),t.YNc(17,It,1,0,"ng-template",null,9,t.W1O)),2&e){const i=t.MAs(18);t.Q6J("ngIf",a.isDesktop),t.xp6(1),t.Q6J("ngIf",!a.isLoading)("ngIfElse",i),t.xp6(1),t.Q6J("formGroup",a.form),t.xp6(1),t.Q6J("ngIf",null==a.provider?null:a.provider.visible_survey),t.xp6(2),t.Q6J("ngForOf",null==a.provider?null:a.provider.options),t.xp6(1),t.Q6J("ngIf",!a.isDesktop),t.xp6(3),t.Q6J("ngIf",!a.onCreating),t.xp6(2),t.Q6J("data-qa","btn-provider-cancel"),t.xp6(1),t.hij(" ",t.lcZ(13,13,"app.cancel")," "),t.xp6(2),t.Q6J("disabled",a.form.invalid||a.submitted)("data-qa","btn-provider-save"),t.xp6(1),t.hij(" ",t.lcZ(16,15,"app.save")," ")}},dependencies:[l.sg,l.O5,l.RF,l.n9,l.ED,D.zL,D.xG,b.Hw,N.O,u.Pi,v.TO,v.KE,v.bx,v.hX,A.gD,C.ey,c._Y,c.Fj,c.JJ,c.JL,c.On,q.Rr,c.sg,c.u,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,T.Nt,y.VQ,y.U0,Y.r,l.rS,u.X$],styles:["h1[_ngcontent-%COMP%]{margin-bottom:32px}.form-controls-panel[_ngcontent-%COMP%]{justify-content:space-between}.form-controls-panel[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start}.mat-slide-toggle[_ngcontent-%COMP%]{margin-bottom:0}.survey[_ngcontent-%COMP%]{margin-bottom:32px}.survey__table[_ngcontent-%COMP%]{width:100%}.survey__table[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{margin:8px 0}@media only screen and (max-width: 1024px){.delete-button[_ngcontent-%COMP%]{padding:0;display:flex;height:48px;min-width:64px;align-items:center;flex-direction:column;justify-content:center;box-shadow:inset 0 0 0 1px var(--color-neutral-60)!important}}"],changeDetection:0})}var Tt=r(11754);function At(n,o){1&n&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"settings.data_sources.data_sources")))}const qt=function(){return["create"]};function Jt(n,o){1&n&&(t.TgZ(0,"mzima-client-button",5)(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"mat-icon",6),t.qZA()),2&n&&(t.Q6J("routerLink",t.DdM(5,qt))("data-qa","btn-add-provider"),t.xp6(2),t.Oqu(t.lcZ(3,3,"settings.data_sources.add_source")))}const Qt=function(n){return["update",n]};function Nt(n,o){if(1&n&&(t.TgZ(0,"div",8)(1,"a",9),t._uU(2),t.qZA()()),2&n){const e=o.$implicit;t.Q6J("data-qa","providers-list"),t.xp6(1),t.Q6J("routerLink",t.VKq(4,Qt,e.id))("data-qa",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Yt(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Nt,3,6,"div",7),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.providersData)}}function Ot(n,o){1&n&&t._UZ(0,"app-spinner",10)}class g{configService;dataSourcesService;breakpointService;isDesktop$;isAllProvidersAdded;providersData;constructor(o,e,a){this.configService=o,this.dataSourcesService=e,this.breakpointService=a,this.isDesktop$=this.breakpointService.isDesktop$}ngOnInit(){this.getProvidersList()}getProvidersList(){this.dataSourcesService.getDataSource().pipe((0,Q.w)(o=>this.configService.getProvidersData(o))).subscribe({next:o=>{this.providersData=S.RD.sortArray(o.filter(e=>e.enabled),"name"),this.isAllProvidersAdded=!!this.providersData.find(e=>!e.enabled)}})}static \u0275fac=function(e){return new(e||g)(t.Y36(Tt.E),t.Y36(f.DS),t.Y36(p.r))};static \u0275cmp=t.Xpm({type:g,selectors:[["app-data-sources"]],decls:7,vars:6,consts:[[1,"form-head-panel"],[4,"ngIf"],[3,"routerLink","data-qa",4,"ngIf"],[4,"ngIf","ngIfElse"],["showLoader",""],[3,"routerLink","data-qa"],["icon","","svgIcon","plus"],[3,"data-qa",4,"ngFor","ngForOf"],[3,"data-qa"],["matRipple","",1,"data-source-item",3,"routerLink","data-qa"],[1,"spinner"]],template:function(e,a){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,At,3,3,"h1",1),t.ALo(2,"async"),t.YNc(3,Jt,5,6,"mzima-client-button",2),t.qZA(),t.YNc(4,Yt,2,1,"ng-container",3),t.YNc(5,Ot,1,0,"ng-template",null,4,t.W1O)),2&e){const i=t.MAs(6);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,a.isDesktop$)),t.xp6(2),t.Q6J("ngIf",!a.isAllProvidersAdded),t.xp6(1),t.Q6J("ngIf",null==a.providersData?null:a.providersData.length)("ngIfElse",i)}},dependencies:[l.sg,l.O5,m.rH,m.yS,D.xG,b.Hw,N.O,C.wG,Y.r,l.Ov,u.X$],styles:[".data-source-item[_ngcontent-%COMP%]{display:flex;cursor:pointer;font-size:14px;line-height:1.5;min-height:48px;font-weight:700;margin-bottom:8px;padding:8px 16px;border-radius:4px;align-items:center;text-decoration:none;color:var(--color-black);background:var(--color-neutral-10);box-shadow:inset 0 0 0 1px var(--color-neutral-20)}@media only screen and (max-width: 1024px){.data-source-item[_ngcontent-%COMP%]{min-height:74px;text-align:center;margin-bottom:16px;justify-content:center}}@media only screen and (max-width: 1024px){.form-head-panel[_ngcontent-%COMP%]{margin-bottom:24px;justify-content:flex-end}}"]})}const Pt=[{path:"",component:g},{path:"update/:id",component:_,data:{breadcrumb:"Data Source"}},{path:"create",component:_,data:{breadcrumb:"Data Source"}}];class h{static \u0275fac=function(e){return new(e||h)};static \u0275mod=t.oAB({type:h});static \u0275inj=t.cJS({imports:[m.Bz.forChild(Pt),m.Bz]})}class x{static \u0275fac=function(e){return new(e||x)};static \u0275mod=t.oAB({type:x});static \u0275inj=t.cJS({imports:[l.ez,h,P.ot,J.Z6,b.Ps,J.Fm,u.aw,A.LD,c.u5,q.rP,c.UX,d.p0,T.c,y.Fk,C.si,L.e]})}}}]);
//# sourceMappingURL=152.87fa98f5c47be837.js.map